var customSearch=false;var buttonObj;var clickSearchMethod;function removeSearchBox(a){if($("#search_shade").length>0){$("#search_shade").removeClass("searchOver");$("#search_box").removeClass("searchBox");$("#search_box").css("display","none");contentResize();if($("button[onclick^='showSearchDIV'] span span").html()=="\u53d6\u6d88\u67e5\u8be2"){$("button[onclick^='showSearchDIV'] span span").html("\u67e5\u8be2")}else{if($("button[id='searchBtn'] span span").html()=="\u53d6\u6d88\u67e5\u8be2"){$("button[id='searchBtn'] span span").html("\u67e5\u8be2")}}}}function fixedToInputWidth(){var a=$("#search_box").width()-450;$(".searchInputClass").css("width",a/4);$(".searchInputClass").css("min-width",84)}function fixedToDynamic(){$("#fixedSearchZoon").css("display","none");$("#searchZoon").css("display","block");if($("#containerSearchInput").val()!="false"){contentResizeForAdvanced()}}function dynamicToFixed(){$("#fixedSearchZoon").css("display","block");$("#searchZoon").css("display","none");if($("#containerSearchInput").val()!="false"){contentResizeForFixed()}}function clearParameter(){var c=$("input[class='searchInputClass hasDatepicker']");var a=$("input[class='searchInputClass']");$.each(a,function(d){$(a[d]).attr("value","")});$.each(c,function(d){$(c[d]).attr("value","")});var b=$("select[class='searchInputClass']");$.each(b,function(e){var d=$(b[e]).children();$.each(d,function(f){if($(d[f]).attr("value")==""){$(d[f]).attr("selected","selected")}})})}function fixedSearchDealWithParameter(c){var b=$(".searchInputClass");var a="[";$.each(b,function(f){var h=$(b[f]).attr("value");if(typeof(h)!="undefined"&&h!=""){var e=$(b[f]).attr("type");var g=$(b[f]).attr("checked");if(e=="radio"&&g!=true){return true}var j=$(b[f]).attr("dataType");var d=$(b[f]).attr("name");a=a+'{"leftBracket":"",';a=a+'"propName":"'+d+'",';a=a+'"dbName":"'+$(b[f]).attr("dbName")+'",';if((j.indexOf("ENUM")>=0)&&h!=""){a=a+'"optSign":"=",';a=a+'"dataType":"'+j+'",';a=a+'"enumName":"'+$(b[f]).attr("enumName")+'",'}else{a=a+'"enumName":"",'}a=a+'"propValue":"';if(j.indexOf("DATE")>=0&&j.split("-")[1]=="first"&&h!=""){a=a+h+' 00:00:00",'}else{if(j.indexOf("DATE")>=0&&j.split("-")[1]=="second"&&h!=""){a=a+h+' 23:59:59",'}else{if(j.indexOf("TIME")>=0&&j.split("-")[1]=="first"&&h!=""){a=a+h+':00",'}else{if(j.indexOf("TIME")>=0&&j.split("-")[1]=="second"&&h!=""){a=a+h+':59",'}else{a=a+h+'",'}}}}a=a+'"rightBracket":"",';if(j.indexOf("STRING")>=0&&h!=""){a=a+'"optSign":"like",';a=a+'"dataType":"'+j+'",'}else{if((j.indexOf("INTEGER")>=0||(j.indexOf("LONG")>=0))&&h!=""){a=a+'"optSign":"=",';a=a+'"dataType":"'+j+'",'}else{if((j.indexOf("DOUBLE")>=0||j.indexOf("FLOAT")>=0||(j.indexOf("NUMBER")>=0)||(j.indexOf("AMOUNT")>=0))&&h!=""){a=a+'"optSign":"=",';a=a+'"dataType":"'+j+'",'}else{if((j.indexOf("BOOLEAN")>=0)&&h!=""){a=a+'"optSign":"=",';a=a+'"dataType":"'+j+'",'}else{if((j.indexOf("TIME")>=0||j.indexOf("DATE")>=0)&&j.split("-")[1]=="first"&&h!=""){a=a+'"optSign":">=",';a=a+'"dataType":"'+j.split("-")[0]+'",'}else{if((j.indexOf("TIME")>=0||j.indexOf("DATE")>=0)&&j.split("-")[1]=="second"&&h!=""){a=a+'"optSign":"<=",';a=a+'"dataType":"'+j.split("-")[0]+'",'}}}}}}a=a+'"joinSign":"and"}';if(f!=b.length){a=a+","}}});a=a+"]";if(a.length==2){$("#search_Parameters").attr("value","")}else{$("#search_Parameters").attr("value",a.substring(0,a.lastIndexOf("}")+1)+"]")}}function fixedSearchSubmit(b,a){var c=getSubmitFormId();$("#__search_parameters").remove();fixedSearchDealWithParameter();var g=$("#search_Parameters").val();var i=$("#"+c).children();$.each(i,function(k){if(typeof($(i[k]).attr("name"))!="undefined"&&$(i[k]).attr("name").toLowerCase().indexOf("pageno")!=-1){$(i[k]).attr("value",1)}});creatSearchParametersInput(c,g);var h=getBodyByTableId(b);var j=getStateForm(h,b);var d=$(j).children();if(d.length>0){$.each(d,function(k){if($(d[k]).attr("id")=="__search_parameters"){$(d[k]).attr("value",g)}else{if($(d[k]).attr("id")!="__search_parameters"){$(j).append("<input type='hidden' id='__search_parameters' searchType='fixed_search' value='"+g+"'/>")}}})}else{$(j).append("<input type='hidden' id='__search_parameters' searchType='fixed_search' value='"+g+"'/>")}var f=getValueFromForm(c);jQuery("#"+b).jqGrid("setGridParam",{url:encodeURI(a),mtype:"post",postData:f,page:1,gridComplete:totalPageSetting}).trigger("reloadGrid");if($("#_have_sub_grid").val()!=""){_temp_mainGrid_id=b;_temp_search_parameters=f;setTimeout("searchSubSubmit();",500)}editing=false;lastsel=null;var e=$("#containerSearchInput").val();if(e=="false"){removeSearchBox()}fixedSearchCallBack()}var _temp_mainGrid_id="";var _temp_search_parameters={};function searchSubSubmit(){var b=$("#"+_temp_mainGrid_id).getDataIDs();var a=getTableId();if(b.length>0){$("#"+_temp_mainGrid_id).jqGrid("setSelection",b[0])}else{jQuery("#"+a).jqGrid("clearGridData")}_temp_mainGrid_id="";_temp_search_parameters={}}function fixedSearchCallBack(){}function _optChange(b){var a=$(b).attr("value");if("is null"==a||"is not null"==a){$("#condition").attr("value","");$("#condition").attr("disabled","disabled");$("#condition").css("background-color","#f5f5f5")}else{$("#condition").attr("disabled","");$("#condition").css("background-color","")}}function changeField(){var f=$("#search_name").val().split("-");if(f.length>1){if(f[0]=="STRING"){$.each(jsonFields,function(k){if(jsonFields[k].enName==f[1]){var n=jsonFields[k].defaultValues;var j=(jsonFields[k].enName).split(".");var h=jsonFields[k].eventType;var l="";if(n!=null&&n.length>0){var g="";$.each(n,function(o){g=g+'<option value="'+n[o].value+'">'+n[o].name+"</option>"});$("#num_sign").html('<option value="like">\u5305\u542b</option>');if(h!=null&&h.length>0&&"ONCHANGE"==h){l='onchange="'+j[j.length-1]+"QueryChange('condition');\""}$("#search_value").html('<select id="condition" '+l+">"+g+"</select>")}else{$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value="like">\u5305\u542b</option><option value="not like">\u4e0d\u5305\u542b</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');if(h!=null&&h.length>0){l='onchange="'+j[j.length-1]+"QueryChange('condition');\"";if("ONCLICK"==h){l='onclick="'+j[j.length-1]+'QueryClick(\'condition\');" readonly="readonly"'}else{if("BLUR"==h){l='onblur="'+j[j.length-1]+'QueryBlur(\'condition\');" readonly="readonly"'}else{if(h.indexOf("/")!=-1){var m=h.split("/");l="onclick=\"formGridTree({currentInputId:'condition',treeType:'"+m[0]+"',isMutiply:'"+m[1]+"',useType:'false'});\" readonly=\"readonly\""}}}}$("#search_value").html('<input id="condition" type="text" onkeyup="validateString(this);" style="width:160px" '+l+"/>")}}})}else{if(f[0]=="ENUM"||f[0]=="BOOLEAN"){$.each(jsonFields,function(k){if(jsonFields[k].enName==f[1]){var m=jsonFields[k].defaultValues;var g="";$.each(m,function(n){g=g+'<option value="'+m[n].value+'">'+m[n].name+"</option>"});$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');var j=(jsonFields[k].enName).split(".");var h=jsonFields[k].eventType;var l="";if(h!=null&&h.length>0&&"ONCHANGE"==h){l='onchange="'+j[j.length-1]+"QueryChange('condition');\""}$("#search_value").html('<select id="condition" '+l+'><option value="">\u8bf7\u9009\u62e9</option>'+g+"</select>")}})}else{if(f[0]=="NUMBER"||f[0]=="AMOUNT"||f[0]=="DOUBLE"||f[0]=="FLOAT"){$.each(jsonFields,function(k){if(jsonFields[k].enName==f[1]){var n=jsonFields[k].defaultValues;var j=(jsonFields[k].enName).split(".");var h=jsonFields[k].eventType;var l="";if(n!=null&&n.length>0){var g="";$.each(n,function(o){g=g+'<option value="'+n[o].value+'">'+n[o].name+"</option>"});$("#num_sign").html('<option value="=">\u7b49\u4e8e</option>');if(h!=null&&h.length>0&&"ONCHANGE"==h){l='onchange="'+j[j.length-1]+"QueryChange('condition');\""}$("#search_value").html('<select id="condition" '+l+">"+g+"</select>")}else{$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value=">">\u5927\u4e8e</option><option value="<">\u5c0f\u4e8e</option><option value=">=">\u5927\u4e8e\u7b49\u4e8e</option><option value="<=">\u5c0f\u4e8e\u7b49\u4e8e</option><option value="<>">\u4e0d\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');if(h!=null&&h.length>0){l='onchange="'+j[j.length-1]+"QueryChange('condition');\"";if("ONCLICK"==h){l='onclick="'+j[j.length-1]+'QueryClick(\'condition\');" readonly="readonly"'}else{if("BLUR"==h){l='onblur="'+j[j.length-1]+'QueryBlur(\'condition\');" readonly="readonly"'}else{if(h.indexOf("/")!=-1){var m=h.split("/");l="onclick=\"formGridTree({currentInputId:'condition',treeType:'"+m[0]+"',isMutiply:'"+m[1]+"',useType:'false'});\" readonly=\"readonly\""}}}}$("#search_value").html('<input id="condition" type="text" onkeyup="value=value.replace(/[^0-9.]/g,\'\');" style="width:160px" '+l+"/>")}}})}else{if(f[0]=="INTEGER"||f[0]=="LONG"){$.each(jsonFields,function(k){if(jsonFields[k].enName==f[1]){var n=jsonFields[k].defaultValues;var j=(jsonFields[k].enName).split(".");var h=jsonFields[k].eventType;var l="";if(n!=null&&n.length>0){var g="";$.each(n,function(o){g=g+'<option value="'+n[o].value+'">'+n[o].name+"</option>"});$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');if(h!=null&&h.length>0&&"ONCHANGE"==h){l='onchange="'+j[j.length-1]+"QueryChange('condition');\""}$("#search_value").html('<select id="condition" '+l+">"+g+"</select>")}else{$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value=">">\u5927\u4e8e</option><option value="<">\u5c0f\u4e8e</option><option value=">=">\u5927\u4e8e\u7b49\u4e8e</option><option value="<=">\u5c0f\u4e8e\u7b49\u4e8e</option><option value="<>">\u4e0d\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');if(h!=null&&h.length>0){l='onchange="'+j[j.length-1]+"QueryChange('condition');\"";if("ONCLICK"==h){l='onclick="'+j[j.length-1]+'QueryClick(\'condition\');" readonly="readonly"'}else{if("BLUR"==h){l='onblur="'+j[j.length-1]+'QueryBlur(\'condition\');" readonly="readonly"'}else{if(h.indexOf("/")!=-1){var m=h.split("/");l="onclick=\"formGridTree({currentInputId:'condition',treeType:'"+m[0]+"',isMutiply:'"+m[1]+"',useType:'false'});\" readonly=\"readonly\""}}}}$("#search_value").html('<input id="condition" type="text" onkeyup="value=value.replace(/[^0-9]/g,\'\');" style="width:160px" '+l+"/>")}}})}else{if(f[0]=="DATE"){$.each(jsonFields,function(j){if(jsonFields[j].enName==f[1]){var k=jsonFields[j].defaultValues;if(k!=null&&k.length>0){var g="";$.each(k,function(l){g=g+'<option value="'+k[l].value+'">'+k[l].name+"</option>"});$("#num_sign").html('<option value="=">\u7b49\u4e8e</option>');$("#search_value").html('<select id="condition">'+g+"</select>")}else{$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value=">">\u5927\u4e8e</option><option value="<">\u5c0f\u4e8e</option><option value=">=">\u5927\u4e8e\u7b49\u4e8e</option><option value="<=">\u5c0f\u4e8e\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');var h='<input id="condition" type="text" readonly="readonly"/>';h=h+'<script type="text/javascript">$("#condition").datepicker({  changeMonth:true, changeYear:true,	showButtonPanel:"true"});<\/script>';$("#search_value").html(h)}}})}else{if(f[0]=="TIME"){$.each(jsonFields,function(j){if(jsonFields[j].enName==f[1]){var k=jsonFields[j].defaultValues;if(k!=null&&k.length>0){var g="";$.each(k,function(l){g=g+'<option value="'+k[l].value+'">'+k[l].name+"</option>"});$("#num_sign").html('<option value="=">\u7b49\u4e8e</option>');$("#search_value").html('<select id="condition">'+g+"</select>")}else{$("#num_sign").html('<option value="=">\u7b49\u4e8e</option><option value=">">\u5927\u4e8e</option><option value="<">\u5c0f\u4e8e</option><option value=">=">\u5927\u4e8e\u7b49\u4e8e</option><option value="<=">\u5c0f\u4e8e\u7b49\u4e8e</option><option value="is null">\u4e3a\u7a7a</option><option value="is not null">\u4e0d\u4e3a\u7a7a</option>');var h='<input id="condition" type="text" readonly="readonly"/>';h=h+'<script type="text/javascript">$("#condition").datetimepicker({"dateFormat":"yy-mm-dd",      changeMonth:true,     changeYear:true,     showSecond: false,	showMillisec: false,	"timeFormat": "hh:mm"});<\/script>';$("#search_value").html(h)}}})}}}}}}}else{var e=$("#left_bracket").children();for(var c=0;c<e.length;c++){if($(e[c]).val()==""){$(e[c]).attr("selected","selected");break}}var d=$("#right_bracket").children();for(var c=0;c<d.length;c++){if($(d[c]).val()==""){$(d[c]).attr("selected","selected");break}}var b=$("#rel_sign").children();for(var c=0;c<b.length;c++){if($(b[c]).val()==""){$(b[c]).attr("selected","selected");break}}$("#num_sign").html("");var a="<input type='text' style='width:160px' />";$("#search_value").html(a)}}function addParameter(){if(typeof($("#condition").attr("value"))=="undefined"||$("#condition").attr("value")==""){var e=$("#num_sign").attr("value");if("is null"==e||"is not null"==e){}else{_showMessage("_query_smessage","\u8bf7\u8f93\u5165\u6761\u4ef6");return}}var d='<tr class="str"><td style="border-right: 0px;">'+getHiddenInput("leftBrackets",$("#left_bracket").val())+$("#left_bracket option:selected").text()+'</td><td style="border-left: 0px;">'+getHiddenInput("searchNames",$("#search_name").val())+$("#search_name option:selected").text()+"</td><td >"+getHiddenInput("numSigns",$("#num_sign").val())+$("#num_sign option:selected").text()+"</td>";if($("#search_name").val().indexOf("ENUM-")==0||$("#search_name").val().indexOf("BOOLEAN-")==0){d=d+'<td style="border-right: 0px;">'+getHiddenInput("searchValues",$("#condition").val())+getEsc($("#condition  option:selected").text())+"</td>"}else{if(getEsc($("#condition  option:selected").text())!=""){d=d+'<td style="border-right: 0px;">'+getHiddenInput("searchValues",$("#condition").val())+getEsc($("#condition  option:selected").text())+"</td>"}else{d=d+'<td style="border-right: 0px;">'+getHiddenInput("searchValues",$("#condition").val())+getEsc($("#condition").attr("value"))+"</td>"}}d=d+'<td style="border-left: 0px;">'+getHiddenInput("rightBrackets",$("#right_bracket").val())+$("#right_bracket option:selected").text()+"</td><td >"+getHiddenInput("relSigns",$("#rel_sign").val())+$("#rel_sign option:selected").text()+'</td><td ><a name="deleteA" class="delete" href="#">\u5220\u9664&nbsp;&nbsp;</a></td><tr>';$(d).insertAfter($("#search_Table tbody tr:last-child")).find(".delete").click(function(){$(this).parent().parent().remove()});var f=$("#left_bracket").children();for(var b=0;b<f.length;b++){if($(f[b]).val()==""){$(f[b]).attr("selected","selected");break}}var c=$("#right_bracket").children();for(var b=0;b<c.length;b++){if($(c[b]).val()==""){$(c[b]).attr("selected","selected");break}}var a=$("#rel_sign").children();for(var b=0;b<a.length;b++){if($(a[b]).val()==""){$(a[b]).attr("selected","selected");break}}}function resetParameter(){var c=$("#search_Table").children().children();for(var d=0;d<c.length;d++){if(typeof($(c[d]).find(".delete"))!="undefined"&&$(c[d]).find(".delete").length>0){if($(c[d]).find(".delete").text()==$($("a[name='deleteA']")[0]).text()){$(c[d]).remove()}}}var f=$("#search_name").children();for(var d=0;d<f.length;d++){if($(f[d]).val()==""){$(f[d]).attr("selected","selected");break}}var g=$("#left_bracket").children();for(var d=0;d<g.length;d++){if($(g[d]).val()==""){$(g[d]).attr("selected","selected");break}}var e=$("#right_bracket").children();for(var d=0;d<e.length;d++){if($(e[d]).val()==""){$(e[d]).attr("selected","selected");break}}var b=$("#rel_sign").children();for(var d=0;d<b.length;d++){if($(b[d]).val()==""){$(b[d]).attr("selected","selected");break}}$("#num_sign").html("");var a="<input type='text' style='width:160px' />";$("#search_value").html(a)}function doSearch(g,b){var a=getSubmitFormId();$("#__search_parameters").remove();submitParameter();var f=$("#search_Parameters").val();if(!validateBracket(f)){alert("\u67e5\u8be2\u6761\u4ef6\u4e2d\u7684\u5de6\u53f3\u5c0f\u62ec\u53f7\u4e0d\u5339\u914d\uff01");return}var c=$("#"+a).children();$.each(c,function(h){if(typeof($(c[h]).attr("name"))!="undefined"&&$(c[h]).attr("name").toLowerCase().indexOf("pageno")!=-1){$(c[h]).attr("value",1)}});if(""!=f){f=processDate(f)}if($("#___searchParameters").val()==undefined){$("#"+a).append("<input type='hidden' name='searchParameters' value='"+f+"' id='___searchParameters'/>")}else{$("#___searchParameters").attr("value",f)}var d=getValueFromForm(a);jQuery("#"+g).jqGrid("setGridParam",{url:encodeURI(b),mtype:"post",postData:d,page:1,gridComplete:totalPageSetting}).trigger("reloadGrid");if($("#_have_sub_grid").val()!=""){_temp_mainGrid_id=g;_temp_search_parameters=d;setTimeout("searchSubSubmit();",500)}editing=false;lastsel=null;var e=$("#containerSearchInput").val();if(e=="false"){removeSearchBox()}}function validateBracket(searchParameters){var tempParameters=eval(searchParameters);var leftBracket=0;var rightBracket=0;if(searchParameters!=""){for(var i=0;i<tempParameters.length;i++){if(tempParameters[i].leftBracket!=""){if(tempParameters[i].leftBracket=="("){leftBracket+=1}if(tempParameters[i].leftBracket=="(("){leftBracket+=2}}if(tempParameters[i].rightBracket!=""){if(tempParameters[i].rightBracket==")"){rightBracket+=1}if(tempParameters[i].rightBracket=="))"){rightBracket+=2}}}}if(leftBracket==rightBracket){return true}else{return false}}function processDate(obj){var searchData=eval(obj);var returnData="";for(var i=0;i<searchData.length;i++){var dataType=searchData[i].dataType;var propValue=searchData[i].propValue;var optSign=searchData[i].optSign;if("DATE"==dataType&&""!=propValue){if(">"==optSign||"<="==optSign){searchData[i].propValue=propValue+" 23:59:59"}else{searchData[i].propValue=propValue+" 00:00:00"}}if("TIME"==dataType&&""!=propValue){if(">"==optSign||"<="==optSign){searchData[i].propValue=propValue+":59"}else{searchData[i].propValue=propValue+":00"}}}return JSON.stringify(searchData)}function validateString(d){var c=$(d).val().replace(" ","");if(c.length<=0||c.length>20){_showMessage("_query_smessage","\u6761\u4ef6\u4e0d\u80fd\u4e3a\u7a7a\u4e14\u957f\u5ea6\u4e0d\u592720");$(d).attr("value",c.substring(0,20))}else{var a;if((a=c.indexOf("{"))>=0||(a=c.indexOf("}"))>=0||(a=c.indexOf("'"))>=0||(a=c.indexOf('"'))>=0){_showMessage("_query_smessage","\u6761\u4ef6\u4e0d\u80fd\u5305\u542b\u7a7a\u683c\u3001\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u548c\u5927\u62ec\u53f7");$(d).attr("value",c.substring(0,a))}}}function getHiddenInput(a,b){return'<input type="hidden" name="'+a+'" value="'+b+'"/>'}function _createInput(f,c,b,d,e){var a=f.substring(10,f.length);$("#hideInput_"+a).html('<input class="searchInputClass" type="hidden" id="'+f+'" dataType= "'+c+'" name="'+b+'" enumName="'+e+'" value="'+d+'"/>')}function getEsc(b){for(var a=0;a<b.length;a++){b=b.replace("<","&lt;");b=b.replace(">","&gt;");b=b.replace("'","&apos;");b=b.replace('"',"&quot;")}return b}function submitParameter(){var a=$("input[name='leftBrackets']");var f=$("input[name='searchNames']");var e=$("input[name='numSigns']");var b=$("input[name='searchValues']");var g=$("input[name='rightBrackets']");var h=$("input[name='relSigns']");var c="[";for(var d=0;d<f.length;d++){if(d!=0){c=c+","}c=c+'{"leftBracket":"'+$(a[d]).val()+'",';c=c+'"propName":"'+$(f[d]).val().split("-")[1]+'",';c=c+'"dbName":"'+$(f[d]).val().split("-")[3]+'",';c=c+'"enumName":"'+$(f[d]).val().split("-")[2]+'",';c=c+'"optSign":"'+$(e[d]).val()+'",';c=c+'"propValue":"'+$(b[d]).val()+'",';c=c+'"rightBracket":"'+$(g[d]).val()+'",';c=c+'"joinSign":"'+$(h[d]).val()+'",';c=c+'"dataType":"'+$(f[d]).val().split("-")[0]+'"}'}c=c+"]";if(c.length==2){c=""}$("#search_Parameters").attr("value",c)}function ajaxSubmit(d,b,c,a){ajaxAnyWhereSubmit(d,b,c,a)}function _showMessage(b,a){if(a!=""){$("#"+b).html(a)}$("#"+b).show("show");setTimeout('$("#'+b+'").hide("show");',3000)}function getBodyByTableId(c){var a=document.getElementById(c);var b=false;while(!b){if(a.nodeName=="BODY"){b=true;return a}a=a.parentNode}return null}function getStateForm(a,c){var b=$("form[name='"+c+"_state_form']");if(b.length==0){$(a).append('<form id ="'+c+'_state_form" name="'+c+'_state_form"></form>');b=$("form[name='"+c+"_state_form']")}return b}var jsonFields;function parseFieldJson(){jsonFields=eval($("#field_list").val());var optionsStr='<option value="" selected="selected">\u8bf7\u9009\u62e9</option>';$.each(jsonFields,function(i){optionsStr=optionsStr+'<option value="'+jsonFields[i].propertyType+"-"+jsonFields[i].enName+"-"+jsonFields[i].enumName+"-"+jsonFields[i].dbName+'">'+jsonFields[i].chName+"</option>"});$("#search_name").html(optionsStr);var searchValueInput="<input type='text' style='width:160px' />";$("#search_value").html(searchValueInput)}function customSearch(h,b,c){$("body").append("<input type='hidden' id='search_Parameters' />");fixedSearchDealWithParameter("customSearch");var f=$("#search_Parameters").val();var e=$("#"+b).children();$.each(e,function(j){if(typeof($(e[j]).attr("name"))!="undefined"&&$(e[j]).attr("name").toLowerCase().indexOf("pageno")!=-1){$(e[j]).attr("value",1)}});$("#"+b).append("<input type='hidden' name='searchParameters' value='"+f+"'/>");var a=getBodyByTableId(h);var g=getStateForm(a,h);var d=$(g).children();if(d.length>0){$.each(d,function(j){if($(d[j]).attr("id")=="__search_parameters"){$(d[j]).attr("value",f)}else{if($(d[j]).attr("id")!="__search_parameters"){$(g).append("<input type='hidden' id='__search_parameters' searchType='fixed_search' value='"+f+"'/>")}}})}else{$(g).append("<input type='hidden' id='__search_parameters' searchType='fixed_search' value='"+f+"'/>")}jQuery("#"+h).jqGrid("setGridParam",{url:encodeURI(c+"?searchParameters="+f),page:1,gridComplete:totalPageSetting}).trigger("reloadGrid")}function customSearchGetJson(){$("body").append("<input type='hidden' id='search_Parameters' />");fixedSearchDealWithParameter("customSearch");var a=$("#search_Parameters").val();return a}function getValueFromForm(a){var c={};var g=$("#"+a).children("input");var e=g.length;for(var d=0;d<e;d++){var b=$(g[d]).attr("name");var f=$(g[d]).attr("value");c[b]=f}return c}function creatSearchParametersInput(a,b){if($("#___searchParameters").val()==undefined){$("#"+a).append("<input type='hidden' id='___searchParameters' name='searchParameters' value='"+b+"'/>")}else{$("#___searchParameters").attr("value",b)}}function getSubmitFormId(){var b=$("#submitForm").val();if(b==null||b==""||b==undefined){var a=$($("#searchArea").parent("form")).attr("id");return a}return b}function moveSearc(){var b=$(window).height();$(".opt-body").click(function(c){var d=c||window.event;if(d.target.className=="btn"&&clickSearchMethod!="clickSearc"){removeSearchBox()}clickSearchMethod=""});var a=$("body");changePosition()}function changePosition(){if($("#containerSearchInput").val()!="false"&&$("#containerSearchInput").val()!=undefined){var a=$("#search_box");var c=$("div.ui-layout-center");var d=c.css("left");var b=c.css("top");if(typeof(d)=="undefined"||typeof(b)=="undefined"){a.css("left",0);a.css("top",35)}else{d=parseInt(d);b=parseInt(b)+35;a.css("left",d);a.css("top",b)}$("#search_box").css("width",$("#opt-content").width()+12);a.css("position","absolute");a.css("z-index","2")}}function becomeNode(b){var a=$("body");b=b.replace("&lt;","<");b=b.replace("&gt;",">");a.append(b)}$(document).ready(function(){if($("#searchArea").length<1){return}var a=$("#searchArea");if(a.length<1){return}becomeNode(a.val());parseFieldJson()});function initSearch(){var a=$("body");if(a.find("div[id='search_shade']").length>0){$("#search_shade").remove();$("#search_box").remove()}var b=$("#searchArea");if(b.length<1){return}becomeNode(b.val());parseFieldJson()}function showSearchDIV(a){alert("\u65b9\u6cd5\u8c03\u7528\u4fee\u6539\uff1a\u8bf7\u628a\u3010showSearchDIV(this);\u3011\u66f4\u6362\u4e3a\u3010iMatrix.showSearchDIV(this);\u3011")}function publicShowSearchDiv(c){clickSearchMethod="clickSearc";var d=$("#containerSearchInput").val();if(d!="false"){if($($(c).children().children()).html()=="\u53d6\u6d88\u67e5\u8be2"){var b=$($(c).children().children()).html("\u67e5\u8be2");removeSearchBox();return}var a=$($(c).children().children()).html("\u53d6\u6d88\u67e5\u8be2");$("#search_box").css("roll","block");$("#search_box").css("display","block");$("#search_header").css("display","none");$("#search_box").css("width",$("#opt-content").width()+12);$("#opt-content").css("height",$(".opt-body").height()-55);$("#search_box").css("min-width",820);fixedToInputWidth();if($("#fixedSearchSignInput").val()<=0){$("#searchZoon").css("display","block")}if($("#parameter_Table").height()==0){contentResizeForAdvanced()}else{contentResizeForFixed()}}else{$("#search_box").addClass("searchBox");$("#search_box").css("display","block");$("#search_header").css("display","block");$("#search_shade").addClass("searchOver");if($("#fixedSearchSignInput").val()<=0){$("#searchZoon").css("display","block")}$("#search_box").css("width",$("#opt-content").width()*4/5);$("#search_box").css("min-width",820);$("#search_box").css("margin-left",-$("#search_box").width()/2);fixedToInputWidth()}}function customSearchSubmit(b){var a=$("#custom_search_grid_id").val();fixedSearchSubmit(a,b)}function packagingCustomSearch(){var parameterInputs=$(".searchInputClass");var dateSign="";$.each(parameterInputs,function(i){var currentValue=$(parameterInputs[i]).attr("name");if(typeof(currentValue)!="undefined"&&currentValue!=""){$(parameterInputs[i]).attr("id","condition"+i);var data=getFieldsData(currentValue);if(data.keyValue==""){if(data.propertyType=="DATE"){if(dateSign==""){$(parameterInputs[i]).attr("dataType","DATE-first")}else{if(dateSign==currentValue){$(parameterInputs[i]).attr("dataType","DATE-second")}}dateSign=currentValue;var scriptDate='<script type="text/javascript">$(\'#'+$(parameterInputs[i]).attr("id")+"').datepicker({ \"dateFormat\":'yy-mm-dd', changeMonth:true, changeYear:true });  <\/script> ";$("#"+$(parameterInputs[i]).attr("id")).parent().append(scriptDate)}else{if(data.propertyType=="TEXT"){$(parameterInputs[i]).attr("dataType","STRING")}else{$(parameterInputs[i]).attr("dataType",data.propertyType)}}}else{var keyValue=eval("({"+data.keyValue+"})");var str="";for(var p in keyValue){if(str==""){str+='<option value="" selected="selected">\u8bf7\u9009\u62e9</option>'}if(p!=""){str+='<option value="'+p+'">'+keyValue[p]+"</option>"}}$(parameterInputs[i]).append(str);if(data.propertyType=="ENUM"){$(parameterInputs[i]).attr("enumName",data.enumName);$(parameterInputs[i]).attr("dataType","ENUM")}else{if(data.propertyType=="TEXT"){$(parameterInputs[i]).attr("dataType","STRING")}}}}});if($("#advancedSearchInput").val()=="true"){$($("#customSearchZoon").find(".btn")).parent().append('<span ><a onclick="fixedToDynamic();" href="#" > \u9ad8\u7ea7\u67e5\u8be2>></a></span>')}}function getFieldsData(name){var customSearchAreaValue=$("#custom_field_list").attr("value");var obj=eval("("+customSearchAreaValue+")");for(var i=0;i<obj.length;i++){if(obj[i].enName==name){return obj[i]}}return null};
